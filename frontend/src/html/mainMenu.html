<!DOCTYPE html>
<html lang="en" class="settings">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Zlow: Browser Cycling Simulator</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://unpkg.com/peerjs@1.5.5/dist/peerjs.min.js"></script>
    <script defer src="../js/workoutMenu.js"></script>
    <link rel="stylesheet" href="../css/hud.css" />
    <link rel="stylesheet" href="../css/menu.css" />
    <style>
      body {
        #sky-gradient {
          position: fixed;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          z-index: -2;
          background: linear-gradient(to bottom, #7cd1f3 0%, #c4eeff 100%);
        }
      }
    </style>
    <link
      rel="icon"
      type="image/svg+xml"
      href="/resources/favicons/ZlowFavicon.svg"
    />
  </head>
  <body>
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    <script type="module" src="../js/menu.js"></script>

    <div id="main-menu-center">
      <div id="welcome-msg">
        <span class="welcome-top">Welcome to</span>
        <span class="welcome-main">
          <img
            src="../../resources/favicons/ZlowFavicon.svg"
            alt="Z"
            class="welcome-logo"
          />low
        </span>
        <span class="welcome-accent"></span>
      </div>

      <div id="main-buttons">
        <div id="start-wrapper">
          <button id="start-btn" type="button" data-workout="free">Quick Ride</button>
        </div>

        <div id="workouts-wrapper">
          <button id="workouts-btn" type="button">Workouts</button>
        </div>

        <div id="menu-links">
          <button id="peer-connect-btn" class="menu-link" data-workout="peerServer">Connect to Peer</button>
          <button id="connect-btn" class="menu-link">Connect Trainer</button>
          <button id="customize-btn" class="menu-link" onclick="window.location.href='playerCustomization.html'">Customize Character</button>
          <button id="settings-btn" class="menu-link">Settings</button>
        </div>
      </div>

      <div id="workout-options" class="hidden">
        <button id="workout-back" class="menu-link">← Back</button>
        <div class="workout-row">
          <button class="workout-option" data-workout="ramp">
            <span class="workout-name">Ramp Test</span>
            <span class="workout-desc">Find your FTP</span>
          </button>
          <button class="workout-option" data-workout="sprint">
            <span class="workout-name">Sprint Intervals</span>
            <span class="workout-desc">30s on / 30s off</span>
          </button>
        </div>
      </div>

      <div id="menu-settings">
        <button id="settings-back" class="menu-link">← Back</button>
        
        <span id="devMode" class="hud-btn">
          <label for="dev-toggle">Dev mode</label>
          <label class="toggle-switch">
            <input type="checkbox" id="dev-toggle" />
            <span class="toggle-slider"></span>
          </label>
        </span>

        <span id="peer-host" class="hud-btn">
          <label for="peer-toggle">Host P2P</label>
          <label class="toggle-switch">
          <input type="checkbox" id="peer-toggle" />
          <span class="toggle-slider"></span>
        </label>
      </span>
        <span id="peer-name" class="hud-btn">
          <label for="name-input">Host name: </label>
          <input id="name-input" />
        </span>
        
        <span id="pacer" class="hud-btn">
          <label for="pacer-speed">Pacer:</label>
          <input id="pacer-speed" type="number" min="5" max="60" value="20" step="1" />
          <span class="speedUnit">km/h</span>
        </span>

        <span id="weight" class="hud-btn">
          <label for="rider-weight">Weight:</label>
          <input id="rider-weight" type="number" min="40" max="150" value="70" step="1" />
          <span class="weightUnit">kg</span>
        </span>

        <span id="units-row" class="hud-btn">
          <label>Units:</label>
          <div class="units-group">
            <div class="seg-toggle">
              <button class="seg-btn active" data-unit="km/h" data-group="speed">km/h</button>
              <button class="seg-btn" data-unit="mph" data-group="speed">mph</button>
            </div>
            <div class="seg-toggle">
              <button class="seg-btn active" data-unit="kg" data-group="weight">kg</button>
              <button class="seg-btn" data-unit="lb" data-group="weight">lb</button>
            </div>
          </div>
        </span>
        
        <button id="connect-strava-btn" class="hud-btn">
          Connect Strava
        </button>
        
        <button id="clear-btn" class="hud-btn">Clear settings</button>
      </div>
    </div>

    <div id="menu-footer">
      <a href="changelog.html">v1.0.0-alpha.3</a>
      <span>·</span>
      <a href="https://github.com/gioandjake/zlow/issues/new/choose" target="_blank">Report a bug</a>
    </div>

    <div id="sky-gradient"></div>

    <!-- Main Menu 3D Background -->
    <a-scene id="mainMenuScene" embedded>
      <!-- Camera -->
      <!-- Can change controls to true if other assets are added to the scene to aid in placement -->
      <a-entity
        camera
        position="-3.44 0.28 2.51"
        rotation="10 -20 0"
        fov="45"
        look-controls="enabled: false"
        wasd-controls="enabled: false"
      ></a-entity>

      <a-light type="ambient" color="#FFF" intensity="0.8"></a-light>
      <a-light
        type="directional"
        color="#FFF"
        intensity="1.5"
        position="-2 5 3"
      ></a-light>

      <a-light
        type="point"
        color="#FFF"
        intensity="5.5"
        position="-2 0 2"
        distance="3"
      ></a-light>

      <!-- Ground plane with solid green color (it's dark to compensate for lighting) -->
      <a-plane
        position="0 0 0"
        rotation="-90 0 0"
        width="50"
        height="50"
        color="#2d5016"
        roughness="1"
      ></a-plane>

      <!-- Assets (we just reuse in game models) -->
      <a-assets>
        <a-asset-item
          id="tree1"
          src="../../resources/models/bgmodels/tree1.glb"
        ></a-asset-item>

        <a-asset-item
          id="bikeGLB"
          src="../../resources/models/playermodels/bikeV4.glb"
        ></a-asset-item>

        <a-asset-item
          id="bush1"
          src="../../resources/models/bgmodels/bush1.glb"
        ></a-asset-item>

        <a-asset-item
          id="cloud1"
          src="../../resources/models/bgmodels/cloud1.glb"
        ></a-asset-item>
        <a-asset-item
          id="cloud2"
          src="../../resources/models/bgmodels/cloud2.glb"
        ></a-asset-item>
        <a-asset-item
          id="cloud3"
          src="../../resources/models/bgmodels/cloud3.glb"
        ></a-asset-item>

        <a-asset-item
          id="house-obj"
          src="../../resources/models/bgmodels/House.glb"
        ></a-asset-item>
        <a-asset-item
          id="tall-building-obj"
          src="../../resources/models/bgmodels/TallBuilding.glb"
        ></a-asset-item>
        <a-asset-item
          id="wide-building-obj"
          src="../../resources/models/bgmodels/WideBuilding.glb"
        ></a-asset-item>
      </a-assets>

      <!--  Main tree -->
      <a-entity
        gltf-model="#tree1"
        position="-2.5 0.1 2"
        rotation="0 80 0"
        scale=".8 .8 .8"
      ></a-entity>

      <!--  Main bike -->
      <a-entity
        gltf-model="#bikeGLB"
        position="-2.65 0 2"
        rotation="0 -10 -20"
        scale=".1 .1 .1"
      ></a-entity>

      <!-- Foreground bush -->
      <a-entity
        gltf-model="#bush1"
        position="-3.8 0 2"
        rotation="0 45 0"
        scale=".3 .3 .3"
      ></a-entity>

      <!-- Some clouds -->
      <a-entity
        gltf-model="#cloud1"
        position="-8 4 -5"
        scale=".1 .1 .1"
      ></a-entity>

      <a-entity
        gltf-model="#cloud2"
        position="-3 8 -9"
        scale=".2 .2 .2"
      ></a-entity>

      <a-entity
        gltf-model="#cloud3"
        position="-16 6 -10"
        scale=".3 .3 .3"
      ></a-entity>

      <a-entity
        gltf-model="#cloud3"
        position="60 20 -10"
        scale=".5 .5 .5"
      ></a-entity>

      <a-entity
        gltf-model="#cloud1"
        position="100 40 -5"
        scale=".4 .4 .4"
      ></a-entity>

      <!-- Some buildings and a house -->
      <a-entity
        gltf-model="#tall-building-obj"
        position="-10 0 -20"
        rotation="0 -50 10"
        scale="1 1 1"
      ></a-entity>

      <a-entity
        gltf-model="#house-obj"
        position="50 0 -18"
        rotation="0 180 0"
        scale="2 2 2"
      ></a-entity>

      <a-entity
        gltf-model="#wide-building-obj"
        position="-16 -0.1 -28"
        rotation="0 -50 10"
        scale="1.2 1.2 1.2"
      ></a-entity>
    </a-scene>

    <script>
      window.addEventListener("DOMContentLoaded", () => {
        if (window.initSettings) window.initSettings();
      });
    </script>
  </body>
</html>
